---
title: "Objects Launched into Space"
subtitle: "INFO 526 - Summer 2024 - Final Project"
author: 
  - name: "Derek Rice"
    affiliations:
      - name: "School of Information, University of Arizona"
description: "Project description"
format:
   html:
    code-tools: true
    code-overflow: wrap
    embed-resources: true
editor: visual
execute:
  warning: false
  echo: false
---

```{r}
#| echo = FALSE
  
if (!require("pacman"))
  install.packages("pacman")

pacman::p_load(tidyverse, 
               dplyr, 
               janitor, 
               lubridate,
               ggplot2,
               readr,
               readxl,
               patchwork,
               gganimate,
               ggrepel,
               spData,
               plotly,
               rnaturalearth
              )


# cite: https://github.com/rfordatascience/tidytuesday/blob/master/data/2024/2024-04-23/readme.md

outer_space_objects <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-04-23/outer_space_objects.csv')

view(outer_space_objects)

objects <- outer_space_objects |>
  na.omit() |>
  mutate(hover = paste0(Entity, "\n", num_objects)) |>
  filter(Entity != "World") 

view(objects)

temp = objects


```

```{r echo = FALSE, #| warning = FALSE}

top_15 <- objects |> # to keep things simple picked top 15 countries 
group_by(Entity)|>
summarize(total = sum(num_objects, na.rm = TRUE))|>
arrange(desc(total)) |>
top_n(total, n=16) |>
select(Entity)

top_15_entity <- top_15$Entity # identify the 15 most active countries - simplify the plot

objects_top_15_countries <- objects |> # getting dataset for top 15 most active countries 
   filter(Entity %in% top_15_entity)

Figure_1 <- ggplot(data = objects_top_15_countries, aes(x=Year, y=num_objects, color = Entity)) +
  geom_smooth(se = FALSE, method = loess) +
  theme(
    axis.text.x = element_text(size = 8, face = "bold"),
    axis.text.y = element_text(size = 8, face = "bold"),
    plot.title = element_text (size = 10, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, face = "plain", hjust = 0.5),
    plot.caption = element_text(size = 6, face = "plain", hjust = 1),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "white"),
    panel.grid.major = element_line(color = "gray90"),
    panel.grid.minor = element_line(color = "gray95")
   ) +
  labs(
    x = "year of launch",
    y = "number of objects launched",
    title = "Figure 1: Number of objects launched into space by year (1957 to 2022)",
    subtitle = "data collected from United Nations Office of Outer Space Affairs",
    caption = "objects are defined as satelllites, probes, landers, crewed spacecrafts, and space station flights",
    colour = "Country"
  )

Figure_1 # ggplot smooth line plot of 1957 to 2022 launch data

```

```{r}
# cite: https://www.youtube.com/watch?v=RrtqBYLf404
# cite: https://plotly-r.com/maps
# cite: https://plotly.com/r/map-configuration/

Figure_2 <- plot_geo(objects,
                          locationmode = "world",
                          frame = ~Year) |>
  add_trace(locations = ~Code,
            z = ~num_objects,
            colorscale = 'Electric',
            text = ~hover,
            hoverinfo = 'text') |>
  layout(title = list(
      text = "<b>Figure 2: Number of Objects Launched into Space by country \n (1957 and 2023)",
      font = list(family = 'Arial', size = 16, color = 'black')   
      ),
           geo = list(
           scope = 'world',
           showland = TRUE,
           landcolor = toRGB("LightGreen"),
           showocean = TRUE,
           oceancolor = toRGB("LightBlue"),
           showcountries = TRUE,
           projection = list(type = "Mercator")),
         font = list(family = 'Arial', size = 12, color = 'black'),
         annotations = list(
           text = "<b>Data Source: tidytuesday,outer_space_objects.csv",
           showarrow = FALSE,
           x = 1,
           y = 0
         )) |>
   config(displayModeBar = FALSE)|>
   colorbar(title = "<b>Number of Objects", color = 'black') 

Figure_2 # interactve map of launched objects by country 1957 to 2023

```

top_15_countries \<- data \|\> \# to keep things simple picked top 15 countries

group_by(Entity)\|\>

summarize(total = sum(num_objects, na.rm = TRUE))\|\>

arrange(desc(total)) \|\>

top_n(total, n=16) \|\>

select(Entity)

```{r}
# The first plot provides data from 1957 to 2022
# to make things more interesting here attempt to extrapolate data out to 2100 
# next plot will provide data from 2001 to 2100 
# we'll see how this goes? 

# plan
# 1 - split the dataset by country - select top 15 countries as of 2022 (simplify the work/code?)
# 2 - use a polynomial to fit a model to the launch data for each country
# 3 - use the model to extrapolate out to 2100
# 4 - recombine the dataset into a single data frame 
# 5 - use Plotly to recreate the above using the extrapolated dataset 

data <-  objects # creating a new object 

new_data <- tibble( # creating the list of years to be used as x to predict number of launches
  Year = seq(2000, 2100, by = 1)
)

extrapolated_data <- tibble() # initialize an object 

# view(data)
# view(new_data)

top_15_countries <- data |> # to keep things simple picked top 15 countries 
  group_by(Entity)|>
  summarize(total = sum(num_objects, na.rm = TRUE))|>
  arrange(desc(total)) |>
  top_n(total, n=16) |>
  select(Entity)

# view(top_15_countries)

country_plus_code <- data |> # need country code to populate maps 
  distinct(Entity, Code) |>
  select(Entity, Code) |>
  semi_join(top_15_countries, by = "Entity")

# view(country_plus_code)

# in the following for loop I extract data for a country
# them model (number of launches = function(year)) as a 2nd order polynomial
# I am using a 2nd order poly because the relationshis is not linear based on visual review of dataset
# Once the model is defined predicted data is calculated and stored in the temp_data variable
# dplyr mutate function is used to populate the temp_data variable with year, predicted launches, 
# and country name
# the loop calculates/predicts launches by country from 2000 to 2100
# the predicted data is stored in the tibble "extrapolated_data"
# bind_rows is used to add new calculations by country to the "extrapolated_data" variable

for (i in 1:nrow(top_15_countries)) {
  country = top_15_countries$Entity[i]
  selected_country <- data |> filter(Entity == country)
  model = lm(num_objects ~ poly(Year,2), data = selected_country)
  temp_data <- new_data |>
    mutate(
      y_pred = round(predict(model, newdata = new_data),0),
      Entity = country
      )
  extrapolated_data <- bind_rows(extrapolated_data,temp_data) 
  }




#1 the "extrapolated_data variable populated in the loop does not contain country code
#2 I could not figure out how to add country codes within the loop - I tried for hours but so it goes
#3 Here the left_join function is used to add country code to the "extrapolated_data" variable
#4 The "extrapolated_data" variable has (i) year, (ii)y_pred, and (iii) Entity. 
#5 The "country_plus_code" has (iii) entity and (iv) code
#6 "y_pred" was rename "Predicted_Launches" to help with legend on map. y_pred originated from the modeling
#7 the model for Russia displayed negative launches at some point into the future so a mutate function was 
#7 used to prevent the map from displaying a negative number 

extrapolated_data <- extrapolated_data |>
  left_join(country_plus_code, by = "Entity") |>
  rename(predicted_launches = y_pred) |>
  mutate(predicted_launches = if_else(predicted_launches < 0, 0, predicted_launches)) |>
  mutate(hover = paste0(Entity, "\n", predicted_launches)) |>
  filter(Entity != "World")

view(extrapolated_data)

# summary(model)

```

```{r echo=FALSE,waring = FALSE}


Figure_3 <- ggplot(data = extrapolated_data, aes(x=Year, y=predicted_launches, color = Entity)) +
  geom_smooth(se = FALSE, method = loess) +
  theme(
    axis.text.x = element_text(size = 8, face = "bold"),
    axis.text.y = element_text(size = 8, face = "bold"),
    plot.title = element_text (size = 10, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 8, face = "plain", hjust = 0.5),
    plot.caption = element_text(size = 6, face = "plain", hjust = 1),
    panel.background = element_rect(fill = "white"),
    plot.background = element_rect(fill = "white"),
    panel.grid.major = element_line(color = "gray90"),
    panel.grid.minor = element_line(color = "gray95")
   ) +
  labs(
    x = "year of launch",
    y = "number of objects launched",
    title = "Figure 3: Predicted number of objects launched into space by year (2000 to 2100)",
    subtitle = "(extrapolated from data collected from United Nations Office of Outer Space Affairs)",
    caption = "objects are defined as satelllites, probes, landers, crewed spacecrafts, and space station flights",
    color = "Country"
  )

Figure_3 # ggplot smooth line plot of predicted launch events 2001 to 2100 

```

```{r}

Figure_4 <- plot_geo(extrapolated_data,
                          locationmode = "world",
                          frame = ~Year) |>
  add_trace(locations = ~Code,
            z = ~predicted_launches,
            zmin = 0,
            colorscale = 'Electric',
            text = ~hover,
            hoverinfo = 'text') |>
  layout(title = list(
      text = "<b>Figure 4: Predicted Number of Objects Launched into Space by Country \n (2001 and 2100)",
      font = list(family = 'Arial', size = 16, color = 'black')   
      ),
           geo = list(
           scope = 'world',
           showland = TRUE,
           landcolor = toRGB("LightGreen"),
           showocean = TRUE,
           oceancolor = toRGB("LightBlue"),
           showcountries = TRUE,
           projection = list(type = "Mercator")),
         font = list(family = 'Arial', size = 12, color = 'black'),
         annotations = list(
           text = "<b>Data Source: extrapolated polynomial model based on tidytuesday,outer_space_objects.csv",
           showarrow = FALSE,
           x = 1,
           y = 0
         )) |>
   config(displayModeBar = FALSE) |>
   colorbar(title = "<b>Number of Objects", color = 'black') 

Figure_4 # interactive map with predicted and extrapolated launch data from 2001 to 2100 

```

## Abstract

The intent of this project was to understand the evolution of countries engaged in rocket and space technologies and predict countries who will dominate space in the near future. To complete the analysis the dataset "yearly number of objects launched into outer space" was leveraged. The dataset provides the number of objects launched into space from 1957 to 2022 as a function of country. The source of the dataset is the United Nations Office of Outer Space Affairs and the dataset is available within the tidytuesday package.

The analysis was completed in two stages. First, the 1957 to 2022 data was analyzed and plotted as a smooth line plot by country and on a world map, see Figures 1 and 2 respectively. These two plots document the early years of the rocket technology and highlight the dominance of Russia during the infancy of rocket technology, see Figure 2. The static smooth line plots and the interactive maps used to tell the space faring story were created using ggplot2 and the Plotly package respectively.

The 1957 to 2022 data was employed to identify the fifteen prominent space faring nations, the countries with the largest number of objects launched. For each of these fifteen countries a second order polynomial regression model was calculated. The country model was utilized to create a second dataset and predict launches between 2001 and 2022 and extrapolate the number of objects launched up to the year 2100. The results of the model and predicted number of launches are displayed on a static ggplot smooth line plot and an interactive world map, see Figures 3 and 4.

The analysis indicates that Russia, once a dominant force in space technologies will fail to keep pace with other nations eventually losing its ability to launch space objects. The work suggests that the United States will dominate space and that China will replace Russia as an important contributor to the industry. Surprisingly the analysis indicates India will rise at the third most active nation with respect to launching objects into space.

## Datasets

### The Space Objects Dataset (1957 to 2023)

-   The dataset summarizes the number of objects launched into space from 1957 to 2023 as a function of entity.
-   The source of the dataset is the United Nations Office of Outer Space Affairs. A prior analysis of the dataset is available here: https://ourworldindata.org/grapher/yearly-number-of-objects-launched-into-outer-space
-   Dataset source: https://github.com/rfordatascience/tidytuesday/blob/master/data/2024/2024-04-23/readme.md
-   The dataset is comprised of 4 columns and 1175 rows - see "head" and "glimpse" summarized herein.
-   I choose the dataset because I was thinking it would be interesting to identify the countries launching gadgets into space and the magnitude of the difference between the United States and other countries.
-   Figure 1: A static graphical plot summary of the data - the plot presents an overview of the dataset and visually displays the number of launches per entity between 1957 and 2023.
-   Figure 2: A dynamic world map - move the slider located on the bottom of the map graphic from 1957 to 2023 to see highlighted countries launching space vehicles each year.

### The Space Objects Predicted (2001 to 2023 and Extrapolated (2024 to 2100) Dataset 

- The origian dataset was used to identify the fifteen most active countries launching gadgets into space.
- A second order polynomial Y (number of objects) = function (interectp + year + year^2) for the fifteen most active countries was calculated.
- The model was used to predict the number of launches between 2001 and 2023 and extrapolate the number of launches up to year 2100.
- The data generated by the model was stored in a dataset called "extrapolated_data" 
- It was this extrapolated dataset that I was most interested in to understand tends in the industry 
- The "extrapolated_data" included five columns (i) Year, (ii) predicted_launches, (iii) Entity, (iv) Code, and (v) hover
- (iii) Entity was the country launching gadgets into space - nomenclature carry over from original dataset
- (iv) Code was the country code needed for identifying the "entity" on the map
- (v) hover was the information displayed when the mouse is hovering over a country on the interactive map  
- Figure 3: A static graphical smooth line plot of the predicted and extrapolated data from 2001 to 2100.
- Figure 4: A dynamic map, zoom in and move around the map, there is a slider located at the base of the map, move the slider to display predicted launch events from 2001 to 2100. 


### Data Variable Descriptions: The Space Objects Dataset (1957 to 2023)

The dataset comprises 4 columns and 1175 rows. The dataset summarizes space launch events between 1957 and 2023 as a function of the entity or country responsible for the launch.

Entity: <character> the country launching the space object

Code: <character> the type of gadget launched into Earth orbit or beyond (satellites, probes, landers, crewed spacecrafts, and space station components)

Year: <double-precision floating-point number> the year of the launch

num_objects: <double-precision floating-point number> the number of objects launched by "Entity" during a year.


### Data Variable Descriptions: The Space Objects Predicted (2001 to 2023 and Extrapolated (2024 to 2100) Dataset

The extrapolated_data dataset comprises 5 columns. The dataset summarizes predicted space launch events from 2001 to 2100 using the second order polynomial regression model generated from the original "space objects dataset". 

Year: <double-precision floating-point number> the year of the launch

predicted_launches:  <double-precision floating-point number> the number of objects launched by "Entity" during a year.

Entity: <character> the country launching the space object

Code: <character> the type of gadget launched into Earth orbit or beyond (satellites, probes, landers, crewed spacecrafts, and space station components)

hover: <character> text used on the interactve map when hovering over a country. Displays country name and number of launch events for year selected using the sliding scale at the base of the map. 


### Question 1: What nation is likely to dominate space in the not so distant future?

Question 1 - what country is most likely to become the first "space faring nation" and is there a close second? I propose to define "space faring nation" as the country that launches an order of magnitude more vehicles into space than all other countries combined. I'll fit a polynomial regression model to the dataset by country and extrapolate the model into the future to help identify the likely candidates.

## Introduction



## Approach



## Analysis




## Discussion








